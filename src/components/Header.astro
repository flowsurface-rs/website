---
// Header component encapsulates site navigation + theme toggle
import Logo from "./Logo.astro";
---

<header
  class="fixed top-0 left-0 right-0 z-50 select-none bg-bg-1 sm:bg-transparent border-b border-border sm:border-none"
>
  <div
    class="w-full flex items-center justify-between gap-2 md:gap-4 p-2 md:px-6 md:py-5"
  >
    <a
      href="#top"
      aria-label="Flowsurface home"
      class="flex items-center font-semibold uppercase opacity-80 hover:opacity-100 transition-opacity"
    >
      <span>
        <Logo class="h-7" encased />
      </span>
    </a>
    <div class="flex items-center gap-2 md:gap-3">
      <a
        href="#download"
        aria-label="Download Flowsurface"
        class="btn btn-primary px-2 py-2 text-[0.65rem] leading-none tracking-wider flex items-center justify-center gap-0 sm:px-3 sm:py-[0.55rem] sm:gap-2"
      >
        <svg
          aria-hidden="true"
          class="h-4 w-4"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M12 3v14"></path>
          <path d="m6 11 6 6 6-6"></path>
          <path d="M5 21h14"></path>
        </svg>
        <span class="hidden sm:inline">Download</span>
      </a>
      <a
        href="https://github.com/flowsurface-rs/flowsurface"
        target="_blank"
        rel="noopener"
        aria-label="View Flowsurface on GitHub"
        class="btn btn-secondary px-2 py-2 text-[0.65rem] leading-none tracking-wider flex items-center justify-center gap-0 sm:px-3 sm:py-[0.55rem] sm:gap-2"
      >
        <svg
          aria-hidden="true"
          class="h-4 w-4"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M12 .5C5.65.5.5 5.65.5 12c0 5.1 3.3 9.4 7.9 10.9.6.1.8-.3.8-.6v-2.1c-3.2.7-3.9-1.4-3.9-1.4-.5-1.2-1.2-1.5-1.2-1.5-1-.7.1-.7.1-.7 1.1.1 1.6 1.2 1.6 1.2 1 .1.5 1.4 2.6 1 .1-.8.4-1.3.7-1.6-2.6-.3-5.3-1.3-5.3-5.9 0-1.3.5-2.3 1.2-3.2-.1-.3-.5-1.5.1-3 0 0 1-.3 3.3 1.2a11.3 11.3 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.5.2 2.7.1 3 .8.9 1.2 2 1.2 3.2 0 4.6-2.7 5.6-5.3 5.9.4.3.8 1 .8 2.1v3.1c0 .3.2.7.8.6A10.97 10.97 0 0 0 23.5 12C23.5 5.65 18.35.5 12 .5Z"
          ></path>
        </svg>
        <span class="hidden sm:inline">GitHub</span>
      </a>
      <button
        id="theme-toggle"
        aria-label="Toggle light/dark theme"
        class="btn btn-secondary px-2 py-2 text-[0.65rem] leading-none tracking-wider flex items-center justify-center gap-0 sm:px-3 sm:py-[0.55rem] sm:gap-2"
      >
        <span
          id="theme-toggle-icon"
          aria-hidden="true"
          class="h-4 w-4 flex items-center justify-center">☾</span
        >
      </button>
    </div>
  </div>
  <script>
    (function () {
      const btn = document.getElementById("theme-toggle");
      const icon = document.getElementById("theme-toggle-icon");
      if (!btn) return;
      function currentTheme() {
        return document.documentElement.classList.contains("light")
          ? "light"
          : "dark";
      }
      function apply(t) {
        if (t === "light") document.documentElement.classList.add("light");
        else document.documentElement.classList.remove("light");
        localStorage.setItem("fs-theme", t);
        if (icon) icon.textContent = t === "light" ? "☀︎" : "☾";
        const meta = document.querySelector('meta[name="theme-color"]');
        if (meta)
          meta.setAttribute("content", t === "light" ? "#f5f7f8" : "#0e0d0d");
      }
      apply(currentTheme());
      btn.addEventListener("click", () => {
        const next = currentTheme() === "light" ? "dark" : "light";
        apply(next);
      });
    })();
  </script>
</header>
